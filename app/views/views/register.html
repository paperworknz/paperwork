<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Register For Paperwork & Free Trial - Paperwork</title>
		<meta name="description" 
		content="Register for Paperwork and get a 14 day free trial, no credit card required.">
		<link rel="canonical" href="{{environment.root}}/{{environment.page}}">
		{% include path.html.head_public %}
		{% include path.html.pixel %}
	</head>
	<body>
		<header>
			<div class="wrap width">
				<div class="nav">
					<div class="major_title logo">
						<a href="{{environment.root}}" title="Paperwork">Paperwork</a>
					</div>
					<ul class="nav_list_less wrap">
						<li>
							<a href="{{environment.root}}" home>Home</a>
						</li>
						<li>
							<a href="{{environment.root}}/login" title="Log In">Log In</a>
						</li>
						<li class="disable no-click">
							<span>Sign Up</span>
						</li>
					</ul>
				</div>
			</div>
		</header>
		<section>
			<div class="width">
				<section class="main centered">
					<div class="main_title">Welcome to Paperwork</div>
					<div class="title">
						Please fill in the boxes below. You can always change these later.
					</div>
					<div>
						All new users get a <b>14 day free trial</b>
					</div>
				</section>
				<section class="user-information centered central">
					<part class="register-information" data-validate="on">
						<section>
							<label>
								First name
							</label>
							<part>
								<input type="text" name="first" required>
							</part>
						</section>
						<section>
							<label>
								Last name
							</label>
							<part>
								<input type="text" name="last" required>
							</part>
						</section>
						<section>
							<label>
								Company name
							</label>
							<part>
								<input type="text" name="company" required>
							</part>
						</section>
						<section>
							<label>
								Email address
							</label>
							<part>
								<input type="email" name="email" required>
							</part>
						</section>
						<section>
							<label>
								Username
							</label>
							<part>
								<input type="text" name="username" required>
							</part>
						</section>
						<section>
							<label>
								Password
							</label>
							<part>
								<input type="password" name="password" required>
							</part>
						</section>
						<section style="padding-bottom: 35px;">
							<label>
								Confirm password
							</label>
							<part>
								<input type="password" name="confirm" required>
							</part>
						</section>
						<section style="display: inline-block;">
							<button class="button next-step left" style="width: 100px">NEXT</button>
						</section>
					</part>
				</section>
			</div>
		</section>
		<footer>
			<div class="centered">
				<div>
					<a href="https://www.facebook.com/paperworkapp" target="_blank" title="Our Facebook Page">
						<img class="fb" src="{{environment.root}}/css/media/icon/facebook/png/FB-f-Logo__blue_29.png">
					</a>
				</div>
				<div style="padding: 15px 0px;">
					<a href="{{environment.root}}/privacy-policy">Privacy Policy</a>
					<div style="padding-top: 15px;font-size: 12px;">
						<p>
							Paperwork New Zealand Limited<br>
							<a href="{{environment.root}}">{{environment.root}}</a><br>
							105 Swamp Road, Kapiti Coast<br>
							hello@paperwork.nz<br>
							+642040268988<br>
						</p>
					</div>
				</div>
			</div>
		</footer>
		<script src="{{environment.root}}/js/3rd/jquery.2.1.4.js"></script>
		<script src="{{environment.root}}/js/library/{{path.js.library.Paperwork}}"></script>
		<script>
			$(function(){
				
				// Helpers
				$('input[name=first]').on('keyup', function(){
					$('input[name=username]').val($(this).val().toLowerCase());
				});
				
				// Login on click (focusing also triggers this)
				$('.next-step').on('click', register);
				
				function register(){
					if(!$('.next-step').hasClass('button-wait')){
						
						$.post('{{environment.root}}/post/register', {
							first: $('input[name=first]').val(),
							last: $('input[name=last]').val(),
							company: $('input[name=company]').val(),
							email: $('input[name=email]').val(),
							username: $('input[name=username]').val(),
							password: $('input[name=password]').val(),
							confirm: $('input[name=confirm]').val(), 
						}).done(function(a){
							a = JSON.parse(a);
							
							if(a.type == 'success'){
								{% if state == 'prod' %}
								fbq('track', 'CompleteRegistration');
								{% endif %}
								$.post('{{environment.root}}/post/login', {
									username: $('input[name=username]').val(),
									password: $('input[name=password]').val(),
								}).done(function(data){
									data = JSON.parse(data);
									
									if(data.type == 'success'){
										window.location = '{{environment.root}}/app';
									}else{
										$('table').before('<div class="alert alert-danger">'+data.message+'</div>');
									}
								});
							}else{
								if($('.alert').length > 0){
									$('.alert').html(a.message);
								}else{
									$('table').before('<div class="alert alert-danger">'+a.message+'</div>');
								}
								Paperwork.ready($('.next-step'), 'LOG IN');
							}
						});
					}
				}
			});
		</script>
	</body>
</html>