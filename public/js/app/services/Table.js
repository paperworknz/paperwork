"use strict";var Table=function(t){this.setMap=function(){localStorage.map=JSON.stringify(this.map)},this.clearMap=function(){delete localStorage.map,location.reload()},this.map={filter:"All",columns:{}},localStorage.map&&(this.map=JSON.parse(localStorage.map)),this.filter(this.map.filter),this.hover(),this.init(),this.run()};Table.prototype.init=function(){var t=this;$(".wt-column").each(function(a){var e=$(this),o=$(this).data("id");void 0!==t.map.columns[o]?e.css("width",t.map.columns[o].width):(t.map.columns[o]={width:e.width()+"px",index:a,state:$(this).find(".wt-head").attr("data-state"),stateOrder:a},t.setMap())});var a=[];$.each(t.map.columns,function(t,e){a[e.stateOrder]=t}),a.reverse(),$.each(a,function(a,e){var o=$('.wt-column[data-id="'+e+'"]');"asc"==t.map.columns[e].state?(o.find("img").css("display","block"),o.find("img").attr("src",environment.root+"/css/app/media/up.png"),o.find(".wt-head").attr("data-state","asc"),t.sort(e,"asc")):"desc"==t.map.columns[e].state?(o.find("img").css("display","block"),o.find("img").attr("src",environment.root+"/css/app/media/down.png"),o.find(".wt-head").attr("data-state","desc"),t.sort(e,"desc")):"def"==t.map.columns[e].state&&(o.find("img").css("display","none"),o.find(".wt-head").attr("data-state","def"),t.sort(e,"def"))});var a=[];$.each(t.map.columns,function(t,e){a[e.index]=$('.wt-column[data-id="'+t+'"]')}),$.each(a,function(t,a){$(".wt-wrap").append(a)}),interact(".wt-column").resizable({edges:{right:!0}}).on("resizemove",function(a){var e=a.target,o=$(e).attr("data-id"),s=a.rect.width+"px";e.style.width=s,t.map.columns[o].width=s,t.setMap()}).allowFrom(".wt-head"),new Sortable(document.getElementById("sortable"),{handle:".wt-head",animation:150,ghostClass:"wt-column-ghost",onEnd:function(a){$.each($(".wt-column"),function(a){t.map.columns[$(this).attr("data-id")].index=a,t.setMap()})}}),$(".wt-row").click(function(){void 0!=$(this).attr("href")&&goto($(this).attr("href"))}),$(".wt-reset").click(function(){t.clearMap()}),$(".wt-table").css("display","block")},Table.prototype.hover=function(){$("[data-row]").on("mouseover",function(){var t=$(this).data("row");$('[data-row="'+t+'"]').each(function(){$(this).addClass("wt-row-hover")})}),$("[data-row]").on("mouseout",function(){var t=$(this).data("row");$('[data-row="'+t+'"]').each(function(){$(this).removeClass("wt-row-hover")})})},Table.prototype.run=function(){var t=this;$(document).on("click","[wt-head]",function(){t.state($(this))}),$(document).on("change",".wt-filter",function(){var a=$(this).val();t.filter(a)})},Table.prototype.state=function(t){var a=this,e=t.closest(".wt-column").attr("data-id"),o=t.parent(".wt-head").attr("data-state"),s=[];switch($.each(a.map.columns,function(t,a){s[a.stateOrder]=t}),"desc"!=o?s.moveTo(e,0):s.moveTo(e,"end"),$.each(a.map.columns,function(t,e){var o=s.indexOf(t);a.map.columns[t].stateOrder=o}),o){case"asc":a.map.columns[e].state="desc",t.find("img").css("display","block"),t.find("img").attr("src",environment.root+"/css/app/media/down.png"),t.parent(".wt-head").attr("data-state","desc"),a.sort(e,"desc");break;case"desc":a.map.columns[e].state="def",t.find("img").css("display","none"),t.parent(".wt-head").attr("data-state","def"),a.sort(e,"def");break;case"def":a.map.columns[e].state="asc",t.find("img").css("display","block"),t.find("img").attr("src",environment.root+"/css/app/media/up.png"),t.parent(".wt-head").attr("data-state","asc"),a.sort(e,"asc")}a.setMap()},Table.prototype.filter=function(t){var a=this;"All"==t?$(".wt-row").each(function(){$(this).show()}):($(".wt-row").each(function(){$(this).hide()}),$('[data-id="Status"] .wt-row').each(function(){if($(this).text()==t){var a=$(this).attr("data-row");$(".wt-row").each(function(){$(this).attr("data-row")==a&&$(this).show()})}})),$(".wt-filter").val(t),a.map.filter=t,a.setMap()},Table.prototype.sort=function(t,a){var e='[data-id="'+t+'"]';$(t).children("li");switch(a){case"def":tinysort(e+" .wt-row",{attr:"data-row"});break;case"asc":tinysort(e+" .wt-row",{order:"asc"});break;case"desc":tinysort(e+" .wt-row",{order:"desc"})}var o=[];$(e+" .wt-row").each(function(){o.push($(this).attr("data-row"))}),$(".wt-column").each(function(){var a=$(this);if(a.attr("data-id")!=t){var e={};$(a).find(".wt-row").each(function(){var t=$(this);e[t.attr("data-row")]=t});for(var s=0,n=o.length;n>s;s++)e[o[s]]&&a.append(e[o[s]])}})},Array.prototype.moveTo=function(t,a){var e=this.indexOf(t);if(-1===e)throw new Error("Element not found in array");0>a&&(a=0),"end"==a&&(a=this.length+1),this.splice(e,1),this.splice(a,0,t)};