"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},Table=function(t,e){function n(){b.on("mouseover",i),b.on("mouseout",i),x.on("click",v),b.on("click",function(){goto(t(this).attr("href"))}),g.find("[wt-head]").on("click",function(){var e=t(this).closest(".wt-column").attr("data-id"),n=t(this).closest(".wt-head");o(e,n)}),S.on("change",function(){var e=t(this).val();c(e),l()}),void 0!=interact&&interact(".wt-column").resizable({edges:{right:!0}}).on("resizemove",function(e){var n=e.target,i=t(n).attr("data-id"),a=e.rect.width+"px";n.style.width=a,m.columns[i].width=a,r()}).allowFrom(".wt-head"),void 0!=Sortable&&new Sortable(document.getElementById("sortable"),{handle:".wt-head",animation:150,ghostClass:"wt-column-ghost",onEnd:function(e){t(".wt-column").each(function(e){m.columns[t(this).attr("data-id")].index=e,r()})}})}function i(t){var e=this.attributes["data-row"].value;g.find('[data-row="'+e+'"]').toggleClass("wt-row-hover")}function a(){if(localStorage.map)return void(m=JSON.parse(localStorage.map));var t=_.filter?_.filter:"All";m={filter:t,columns:{}},y.each(function(t){var e=this.attributes["data-id"].value,n=_.width[e]?_.width[e]:"";m.columns[e]={index:t,state:"def",stateOrder:t,width:n}}),r()}function r(){return localStorage?void(localStorage.map=JSON.stringify(m)):void console.warn("Unable to save map to localStorage")}function o(t,e){function n(t,e,n){var i=t.indexOf(e);if(-1===i)throw new Error("Element not found in array");return 0>n&&(n=0),"end"==n&&(n=t.length+1),t.splice(i,1),t.splice(n,0,e),t}var i=e.attr("data-state"),a=[];for(var o in m.columns){var s=m.columns[o];a[s.stateOrder]=o}switch(a="desc"!=i?n(a,t,0):n(a,t,"end"),i){case"asc":i="desc",m.columns[t].state=i;break;case"desc":i="def",m.columns[t].state=i;break;case"def":i="asc",m.columns[t].state=i}for(var c in m.columns){var d=(m.columns[c],a.indexOf(c));m.columns[c].stateOrder=d}r(),l()}function l(){var n,i=[],a=[];n=d();for(var r in n){n[r];S.find('option[value="'+r+'"]').length||S.append('\n				<option value="'+r+'">\n					'+r+"\n				</option>\n			")}S.val(m.filter),"All"==m.filter?b.show():!function(){var e=[];b.hide(),n[m.filter]?e=n[m.filter].status:e[0]=m.filter,y.filter('[data-id="Status"]').find(".wt-row").each(function(){var n=this;-1!==e.indexOf(t(this).text())&&!function(){var e=n.attributes["data-row"].value;b.each(function(){this.attributes["data-row"].value==e&&t(this).show()})}()})}(),a=function(t){for(var e in t){var n=t[e];a[n.index]=y.filter('[data-id="'+e+'"]')}return a}(m.columns);for(var o in a){var l=a[o];t(".wt-wrap").append(l)}i=function(t){for(var e in t){var n=t[e];i[n.stateOrder]=e}return i.reverse()}(m.columns);for(var c in i){var f=i[c],u=y.filter('[data-id="'+f+'"]');"asc"==m.columns[f].state?(u.find("img").css("display","block"),u.find("img").attr("src",e.root+"/css/media/up.png"),u.find(".wt-head").attr("data-state","asc"),s(f,"asc")):"desc"==m.columns[f].state?(u.find("img").css("display","block"),u.find("img").attr("src",e.root+"/css/media/down.png"),u.find(".wt-head").attr("data-state","desc"),s(f,"desc")):"def"==m.columns[f].state&&(u.find("img").css("display","none"),u.find(".wt-head").attr("data-state","def"),s(f,"def"))}for(var v in m.columns){var w=m.columns[v];y.filter("[data-id="+v+"]").css("width",w.width)}g.css("display","block")}function s(e,n){var i='.wt-column[data-id="'+e+'"]',a=(t(i).find(".wt-row"),[]);switch(n){case"def":tinysort(i+" .wt-row",{attr:"data-row"});break;case"asc":tinysort(i+" .wt-row",{order:"asc"});break;case"desc":tinysort(i+" .wt-row",{order:"desc"})}t('.wt-column[data-id="'+e+'"] .wt-row').each(function(){a.push(t(this).attr("data-row"))}),y.each(function(){var n=this,i=t(this);t(this).attr("data-id")!=e&&!function(){var e={};t(n).find(".wt-row").each(function(){e[t(this).attr("data-row")]=t(this)});for(var r=0,o=a.length;o>r;r++)e[a[r]]&&i.append(e[a[r]])}()})}function c(t){t||(t="All"),S.find('[value="'+t+'"]').length||console.warn("Filter "+t+" unavailable"),m.filter=t,r()}function d(){return localStorage?(localStorage.filter||(localStorage.filter=JSON.stringify({})),JSON.parse(localStorage.filter)):void console.warn("Unable to access localStorage")}function f(t,e){var n=d();return"string"===!("undefined"==typeof t?"undefined":_typeof(t))?void console.warn("No filter name given for new filter"):(n[t]=e,void(localStorage.filter=JSON.stringify(n)))}function u(t){var e=d();e[t]&&delete e[t],localStorage.filter=JSON.stringify(e)}function v(){var e=Paperwork.dark(),n=e.object,i=e.object.find(".dark_object");i.after('\n		<div class="wt-filter-interface">\n			<part class="container-top">\n				<div class="h3 title centered">\n					Filter Settings\n				</div>\n			</part>\n			<part class="container-mid">\n				<table class="wt-filter-interface_table">\n					<tbody>\n						<tr>\n							<td class="wt-border">\n								<div class="wt-title">\n									My Filters\n								</div>\n								<div class="wt-existing-filters_container">\n								</div>\n							</td>\n							<td class="wt-new-box">\n								<div class="wt-title centered">\n									Create New Filter\n								</div>\n								<div class="wrap" style="padding-bottom:5px;">\n									<div class="wt-filter-interface_table-label">\n										New Filter Name\n									</div>\n									<div class="left">\n										<input type="text" placeholder="Name" class="wt-filter-name" required />\n									</div>\n								</div>\n								<div class="wrap">\n									<div class="wt-filter-interface_table-label">\n										Filter By\n									</div>\n									<div class="left">\n										<select class="wt-filter-facade">\n										</select>\n									</div>\n								</div>\n								<div class="wt-filter-facade_container">\n								</div>\n							</td>\n						</tr>\n					</tbody>\n				</table>\n			</part>\n			<part class="container">\n				<table class="wt-filter-interface_table">\n					<tbody>\n						<tr>\n							<td>\n								<div class="wrap">\n									<button class="button right wt-existing-filter-apply">\n										APPLY\n									</button>\n								</div>\n							</td>\n							<td>\n								<div class="wrap">\n									<button class="button right wt-new-filter-apply">\n										APPLY\n									</button>\n								</div>\n							</td>\n						</tr>\n					</tbody>\n				</table>\n			</part>\n		</div>\n	'),t(".wt-filter-interface").css({top:t(window).height()/2-t(".wt-filter-interface").height()/2});var a=t(".wt-filter-interface"),r=d();t.isEmptyObject(r)&&(a.find(".wt-existing-filters_container").html("\n			<div>\n				You don't have any custom filters\n			</div>\n		"),a.find(".wt-existing-filter-apply").hide());for(var o in r){var s=r[o];a.find(".wt-existing-filters_container").append('\n			<div style="wt-existing-filter">\n				<input data-filter="'+o+'" title="'+s.status+'" class="wt-existing-filter_input" type="text" placeholder="'+o+'" value="'+o+'" required />\n				<span class="wt-existing-filter_remove">remove</span>\n			</div>\n		')}n.on("click",".wt-existing-filter_remove",function(){var e=t(this).prev().attr("data-filter");u(e),S.val()==e&&c("All"),S.find('option[value="'+e+'"]').remove(),l(),t(this).parent().remove()}),S.find("option").each(function(){var e=t(this).attr("value");r[e]||"All"==e||a.find(".wt-filter-facade").append('\n				<option value="'+e+'">\n					'+e+"\n				</option>\n			")}),a.find(".wt-filter-facade").val(""),a.find(".wt-filter-facade").on("change",function(){var e=t(this).val();a.find(".wt-filter-facade_container").append('\n			<div class="wt-multi-select">\n				<div class="wt-multi-select_object">\n					'+e+'\n				</div>\n				<span class="wt-multi-select_remove">x</span>\n			</div>\n		'),t(this).find('option[value="'+e+'"]').hide(),t(this).val("")}),n.on("click",".wt-multi-select_remove",function(){var e=t(this).prev().html().trim();a.find('.wt-filter-facade option[value="'+e+'"]').show(),t(this).closest(".wt-multi-select").remove()}),e.run(function(){t(".wt-filter-interface").animate({opacity:1},100)}),a.find(".wt-existing-filter-apply").on("click",function(){t(".wt-existing-filter_input").each(function(){var e=t(this).attr("data-filter"),n=t(this).val().trim(),i=d();i[e]&&(u(e),f(n,{status:i[e].status})),S.val()==e&&c("All"),S.find('option[value="'+e+'"]').remove(),l(),Paperwork.saved()})}),a.find(".wt-new-filter-apply").on("click",function(){var n=[],i=t(".wt-filter-interface .wt-filter-name").val().trim();t(".wt-filter-interface .wt-multi-select_object").each(function(){var e=t(this).html().trim();n.push(e)}),d(),f(i,{status:n}),t(".wt-filter-interface").fadeOut(100,function(){e.remove(function(){l(),c(i),l(),t(".wt-filter-interface").off().unbind().remove()})})}),i.on("click",function(){t(".wt-filter-interface").fadeOut(100,function(){e.remove(function(){t(".wt-filter-interface").off().unbind().remove()})})})}function w(t){if(!t)return console.warn("No configuration supplied"),!1;if(a(),t.filter&&c(t.filter),t.width)for(var e in t.width){var n=t.width[e];_.width[e]&&(_.width[e]=n)}p()}function p(){n(),a(),l()}function h(){localStorage&&delete localStorage.map,p()}var m,g=t(".wt-table"),b=g.find(".wt-row"),y=g.find(".wt-column"),S=g.find(".wt-filter"),x=g.find(".wt-settings"),_={filter:"All",width:{ID:"44px",Name:"260px",Client:"165px",Status:"111px"}};return{configure:w,run:p,reset:h}}(jQuery,environment);