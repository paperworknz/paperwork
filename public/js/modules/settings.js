"use strict";Core.addModule("settings",function(t){function n(){c.on("keyup",'[data-type="address"]',function(){var t=h.toText($(this));c.find('.user-details input[name="address"]').val(t.html().trim())})}function a(){new Sortable(document.getElementById("job-status"),{handle:".status-handle",animation:150,ghostClass:"status-hover",onEnd:o}),u.on("click",'[data-type="new-status"]',e),u.on("change",".jobstatus ul input",o)}function e(){u.find(".jobstatus ul").append('\n			<li>\n				<input type="text" placeholder="Status name" />\n				<div class="status-handle">\n				</div>\n			</li>\n		')}function o(){var t=[];u.find(".jobstatus ul input").each(function(){return void 0==$(this).data("id")?($(this).val()&&t.push({name:$(this).val()}),!0):void($(this).val()&&t.push({id:$(this).data("id"),name:$(this).val()}))}),$.post(v.status.post,{data:t}).done(function(){Paperwork.send("notification","Saved")})}function i(){m.on("blur",".email-address",function(){var t=$(this).val(),n=m.find(".email-settings input[name=smtp]"),a=m.find(".email-settings input[name=protocol]"),e=m.find(".email-settings input[name=port]");-1!=t.indexOf("@gmail")&&(n.val("smtp.gmail.com"),a.val("TLS"),e.val("587")),-1==t.indexOf("@hotmail")&&-1==t.indexOf("@live")||(n.val("smtp.live.com"),a.val(""),e.val("465")),-1!=t.indexOf("@outlook")&&(n.val("smtp-mail.outlook.com"),a.val("TLS"),e.val("587"))}),m.on("click",".email-signature button",function(){$.post(v.email.put,{signature:m.find(".signature").html()}).done(function(){Paperwork["goto"](environment.root+"/"+environment.page)})})}function s(){f.on("click",'[data-type="trash"]',function(){var t=$(this).data("id"),n=$(this).data("item");t&&n&&r(t,n)}),f.on("click",'[data-type="empty-trash"]',d)}function r(t,n,a){f.css("opacity",.5),f.attr("disabled",""),$.post(v.trash.put,{id:t,type:n}).done(function(e){f.css("opacity",1),f.removeAttr("disabled"),f.find('[data-item="'+n+'"][data-id="'+t+'"]').parent().remove(),a&&a()})}function d(){f.css("opacity",.5),f.attr("disabled",""),$.post(v.trash.post).done(function(t){Paperwork["goto"](environment.root+"/"+environment.page)})}function l(){return annyang?localStorage.annyang&&"true"===localStorage.annyang?(c.find('[data-type="annyang"]').append('\n			<part class="container">\n				Voice control is currently enabled.\n			</part>\n			<part class="container">\n				<button data-type="annyang-switch" class="button delete">Disable</button>\n			</part>\n		'),p()):(localStorage.annyang="false",c.find('[data-type="annyang"]').append('\n				<part class="container">\n					Voice control is currently disabled.\n				</part>\n				<part class="container">\n					<button data-type="annyang-switch" class="button">Enable</button>\n				</part>\n			'),p()):c.find('[data-type="annyang"]').append('\n				<part class="container">\n					Your browser has not adopted the Speech Recognition standard yet - sorry!\n				</part>\n			')}function p(){c.on("click",'[data-type="annyang-switch"]',function(){localStorage.annyang=$(this).hasClass("delete")?"false":"true",Paperwork["goto"](environment.root+"/"+environment.page)})}var c=t.element,u=(c.find('[data-type="account-container"]'),c.find('[data-type="job-container"]')),m=c.find('[data-type="email-container"]'),f=c.find('[data-type="trash-container"]'),v={status:{post:environment.root+"/post/status"},email:{put:environment.root+"/put/email-signature"},trash:{put:environment.root+"/put/restore",post:environment.root+"/post/empty-trash"}},h=t.require("parse");t.use("tab"),n(),a(),i(),s(),l()});