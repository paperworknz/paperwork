"use strict";Core.addModule("settings",function(t){function n(){new Sortable(document.getElementById("job-status"),{handle:".status-handle",animation:150,ghostClass:"status-hover",onEnd:e}),p.on("click",'[data-type="new-status"]',a),p.on("change",".jobstatus ul input",e)}function a(){p.find(".jobstatus ul").append('\n			<li>\n				<input type="text" placeholder="Status name" />\n				<div class="status-handle">\n				</div>\n			</li>\n		')}function e(){var t=[];p.find(".jobstatus ul input").each(function(){return void 0==$(this).data("id")?($(this).val()&&t.push({name:$(this).val()}),!0):void($(this).val()&&t.push({id:$(this).data("id"),name:$(this).val()}))}),$.post(f.status.post,{data:t}).done(function(){Paperwork.send("notification","Saved")})}function o(){u.on("blur",".email-address",function(){var t=$(this).val(),n=u.find(".email-settings input[name=smtp]"),a=u.find(".email-settings input[name=protocol]"),e=u.find(".email-settings input[name=port]");-1!=t.indexOf("@gmail")&&(n.val("smtp.gmail.com"),a.val("TLS"),e.val("587")),-1==t.indexOf("@hotmail")&&-1==t.indexOf("@live")||(n.val("smtp.live.com"),a.val(""),e.val("465")),-1!=t.indexOf("@outlook")&&(n.val("smtp-mail.outlook.com"),a.val("TLS"),e.val("587"))}),u.on("click",".email-signature button",function(){$.post(f.email.put,{signature:u.find(".signature").html()}).done(function(){Paperwork["goto"](environment.root+"/"+environment.page)})})}function i(){m.on("click",'[data-type="trash"]',function(){var t=$(this).data("id"),n=$(this).data("item");t&&n&&s(t,n)}),m.on("click",'[data-type="empty-trash"]',r)}function s(t,n,a){m.css("opacity",.5),m.attr("disabled",""),$.post(f.trash.put,{id:t,type:n}).done(function(e){m.css("opacity",1),m.removeAttr("disabled"),m.find('[data-item="'+n+'"][data-id="'+t+'"]').parent().remove(),a&&a()})}function r(){m.css("opacity",.5),m.attr("disabled",""),$.post(f.trash.post).done(function(t){Paperwork["goto"](environment.root+"/"+environment.page)})}function l(){return annyang?localStorage.annyang&&"true"===localStorage.annyang?(c.find('[data-type="annyang"]').append('\n			<part class="container">\n				Voice control is currently enabled.\n			</part>\n			<part class="container">\n				<button data-type="annyang-switch" class="button delete">Disable</button>\n			</part>\n		'),d()):(localStorage.annyang="false",c.find('[data-type="annyang"]').append('\n				<part class="container">\n					Voice control is currently disabled.\n				</part>\n				<part class="container">\n					<button data-type="annyang-switch" class="button">Enable</button>\n				</part>\n			'),d()):c.find('[data-type="annyang"]').append('\n				<part class="container">\n					Your browser has not adopted the Speech Recognition standard yet - sorry!\n				</part>\n			')}function d(){c.on("click",'[data-type="annyang-switch"]',function(){localStorage.annyang=$(this).hasClass("delete")?"false":"true",Paperwork["goto"](environment.root+"/"+environment.page)})}var c=t.element,p=(c.find('[data-type="account-container"]'),c.find('[data-type="job-container"]')),u=c.find('[data-type="email-container"]'),m=c.find('[data-type="trash-container"]'),f={status:{post:environment.root+"/post/status"},email:{put:environment.root+"/put/email-signature"},trash:{put:environment.root+"/put/restore",post:environment.root+"/post/empty-trash"}};t.use("tab"),n(),o(),i(),l()});