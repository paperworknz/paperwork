"use strict";Core.addModule("client",function(t){function e(){s.on("change",'.client-details input, [data-type="name"], [data-type="address"]',i),s.on("blur",'[data-type="address"]',i)}function n(){s.on("click",'[data-type="new-job"]',function(){Paperwork["goto"](environment.root+"/jobs?id="+u)})}function i(){if(s.find('[data-type="name"]').val().trim()){var t=m.toText(s.find('[data-type="address"]'));$.post(c.put,{id:u,name:s.find('[data-type="name"]').val().trim(),address:t.html().trim(),email:s.find('[data-type="email"]').val().trim(),phone:s.find('[data-type="phone"]').val().trim()}).done(function(t){Paperwork.send("notification")})}}function o(){s.on("click","button.delete",function(){var t=$(this),e=$(this).html();swal({title:"Are you sure you want to delete this client?",text:"Deleting this client will delete ALL jobs, quotes and invoices!",showCancelButton:!0,closeOnConfirm:!0},function(n){return n?void s.find('form[name="delete"]').submit():Paperwork.ready(t,e)})})}function a(){s.on("keyup",'[data-type="notes"]',function(){var t;t=m.toText($(this)),console.log(t.html().trim()),d(t.html().trim())})}function d(t){clearTimeout(l),l=setTimeout(function(){$.post(c.put,{id:u,notes:t}).done(function(t){Paperwork.send("notification","Saved")})},500)}function r(){s.on("click",'[data-type="email-button"]',function(){var e=s.find('[data-type="email"]').val();t.load("email",{address:e})})}var l,s=t.element,u=s.data("id"),c={get:environment.root+"/jobs",put:environment.root+"/put/client-details"},m=t.require("parse");t.use("tab"),e(),n(),o(),a(),r()});