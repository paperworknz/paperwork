"use strict";Core.addModule("client",function(t){function e(){r.on("change",'.client-details input, [data-type="name"], [data-type="address"]',n),r.on("blur",'[data-type="address"]',n)}function n(){if(r.find('[data-type="name"]').val().trim()){var t=c.toText(r.find('[data-type="address"]'));$.post(u.put,{id:s,name:r.find('[data-type="name"]').val().trim(),address:t.html().trim(),email:r.find('[data-type="email"]').val().trim(),phone:r.find('[data-type="phone"]').val().trim()}).done(function(t){Paperwork.send("notification")})}}function i(){r.on("click","button.delete",function(){var t=$(this),e=$(this).html();swal({title:"Are you sure you want to delete this client?",text:"Deleting this client will delete ALL jobs, quotes and invoices!",showCancelButton:!0,closeOnConfirm:!0},function(n){return n?void r.find('form[name="delete"]').submit():Paperwork.ready(t,e)})})}function a(){r.on("keyup",'[data-type="notes"]',function(){var t;t=c.toText($(this)),console.log(t.html().trim()),o(t.html().trim())})}function o(t){clearTimeout(l),l=setTimeout(function(){$.post(u.put,{id:s,notes:t}).done(function(t){Paperwork.send("notification","Saved")})},500)}function d(){r.on("click",'[data-type="email-button"]',function(){var e=r.find("[client-email]").val();t.load("email",{address:e})})}var l,r=t.element,s=r.data("id"),u={get:environment.root+"/jobs",put:environment.root+"/put/client-details"},c=t.require("parse");t.use("tab"),e(),i(),a(),d()});