"use strict";Core.addModule("document-copy",function(e){function t(){n.on("keyup",'[data-type="job_number"]',a),n.on("keydown",'[data-type="job_number"]',a),n.on("blur",'[data-type="job_number"]',function(){var e=$(this).val().trim();return a(),e?void $.get(i.get+"/"+e).done(function(e){e=JSON.parse(e),"error"==e.type&&(n.find('[data-type="job_number"]').val("").removeClass("ok").addClass("error").blur(),setTimeout(function(){n.find('[data-type="job_number"]').removeClass("error")},500)),"success"==e.type&&(n.find('[data-type="job_number"]').addClass("ok"),n.find('[data-type="job_id"]').val(e.job_id).blur())}):void $(this).removeClass("ok")}),n.on("click",'[data-type="new-document"]',function(){var t=r.toNumber(n.find('[data-type="job_number"]').val()),a=r.toNumber(n.find('[data-type="job_id"]').val())||e.data.job_id,o=$(this).data("template-id");d({job_id:a,job_number:t,template_id:o})}),n.on("click",'[data-type="cancel-button"]',o)}function a(){n.find('[data-type="job_id"]').val("")}function o(){e.stop()}function d(t){delete e.data.document_data.date,Paperwork.send("new-document",{job_id:t.job_id,job_number:t.job_number,template_id:t.template_id,document:e.data.document_data}),o()}var n=e.element,r=e.require("parse"),i={get:environment.root+"/get/job"};t(),n.find('[data-type="job_number"]').val(e.data.job_number).attr("placeholder",e.data.job_number).blur(),Paperwork.validate(n.find(".copy-parent"),n.find('[data-type="new-document"]'),"document-copy")});