"use strict";Core.addModule("clients",function(e){function n(){$.get(d.get).done(function(e){r=JSON.parse(e);for(var n in r)c.push(r[n].name);t()})}function t(){o.off(),o.on("click",".create-new",function(){o.find("#new-content").slideToggle(100)}),o.on("click",'[data-type="new-client"]',function(){var e=o.find("input[name=name]").val();e.length>0&&$.post(d.post,{name:e}).done(function(e){var n=JSON.parse(e);"success"==n.type?a(n.client.client_number,n.client.name):$("#content").prepend('\n							<flash class="box-std">\n								<div class="alert alert-danger">\n									'+n.message+"\n								</div>\n							</flash>\n						")})}),o.find(".typeahead").typeahead({hint:!0,highlight:!0,minLength:0},{source:substringMatcher(c),limit:1e6}),o.on("keydown",".typeahead",function(e){var n=jQuery.Event("keydown");n.keyCode=n.which=9,13==e.which&&(o.find(".typeahead").trigger(n),i())}),o.on("typeahead:beforeclose",".typeahead",function(e){e.preventDefault()}),o.on("typeahead:selected",".typeahead",i),o.find(".tt-input").focus()}function a(e,n){c.unshift(n),r.push({client_number:e,name:n}),o.find("#the-basics").html('<input type="text" class="typeahead" placeholder="Quick Search">'),Paperwork.ready(o.find('[data-type="new-client"]'),"CREATE"),t()}function i(){var e=o.find(".tt-input").val();for(var n in r){var t=r[n];t.name==e&&Paperwork["goto"](environment.root+"/client/"+t.client_number)}}var o=e.element,c=[],r=[],d={get:environment.root+"/get/clients",post:environment.root+"/post/client"};n()});