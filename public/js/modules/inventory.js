"use strict";Core.addModule("inventory",function(n){function e(){var n=v.find(".filter").val().toLowerCase();for(var e in l){var i=l[e],t=i.name.toLowerCase();i.display=-1!==t.indexOf(n)}o()}function i(){v.find("[data-id]").each(function(){var n=$(this).data("id"),e=$(this).find('input[name="name"]').val(),i=$(this).find('input[name="price"]').val();l[n]={display:!0,name:e,price:i}})}function t(){var n=v.find('.inventory-add input[name="name"]'),e=v.find('.inventory-add input[name="price"]');$.post(s.post,{name:n.val(),price:e.val()}).done(function(i){i=JSON.parse(i),Paperwork.ready(v.find(".inventory-add .button"),"ADD"),n.val(""),e.val(""),n.focus(),Paperwork.send("inventory.add",{id:i.id,name:i.name,price:i.price}),Paperwork.send("notification","Saved")})}function a(n){return n.id?(n.price||(n.price=0),l[n.id]={display:!0,name:n.name,price:n.price},void o()):void console.warn("ID not suppied")}function o(){c.html("");for(var n in l){var e=l[n];e.display&&(e.price=Paperwork.dollar(e.price,{sign:!1}),c.prepend('\n				<li data-id="'+n+'">\n					<div class="item">\n						<input type="text" name="name" style="width: 100%;" value="'+e.name+'" placeholder="'+e.name+'">\n						<input type="text" name="price" class="firm-right" value="'+e.price+'" placeholder="'+e.price+'">\n					</div>\n					<div data-type="remove" class="invremove">x</div>\n				</li>\n			'))}}function r(){c.on("mouseover","li",function(){$(this).find(".item").addClass("item_hover"),$(this).find(".invremove").css("opacity","1")}),c.on("mouseout","li",function(){$(this).find(".item").removeClass("item_hover"),$(this).find(".invremove").css("opacity","0")})}function d(){v.on("change","ul input",function(){var n=$(this).closest("[data-id]"),e=n[0].attributes["data-id"].value,i=n.find('input[name="name"]').val(),t=n.find('input[name="price"]').val();i.length&&t.length&&e.length&&(l[e].name=i,l[e].price=t,$.post(s.put,{id:e,name:i,price:t}).done(function(n){n=JSON.parse(n),l[n.id].name=n.name,l[n.id].price=n.price,o(),Paperwork.send("notification","Saved")}))})}function p(){var n=$(this).closest("[data-id]");$.post(s["delete"],{id:n[0].attributes["data-id"].value}).done(function(e){n.remove(),Paperwork.send("notification","Saved")})}var v=n.element,c=v.find(".inventory-list"),s={put:environment.root+"/put/inv",post:environment.root+"/post/inv","delete":environment.root+"/delete/inv"},l={};i(),d(),r(),o(),v.on("click",".inventory-add .button",t),v.on("click",'[data-type="remove"]',p),Paperwork.on("inventory.add",a),Paperwork.validate(v.find(".inventory-add"),v.find(".inventory-add .button"),Paperwork.random(6),{allowDuplicates:!0}),v.on("keyup",".filter",e)});