"use strict";Core.addModule("inventory",function(n){function e(){var n=p.find(".filter").val().toLowerCase();for(var e in l){var i=l[e],a=i.name.toLowerCase();i.display=-1!==a.indexOf(n)}o()}function i(){p.find("[data-id]").each(function(){var n=$(this).data("id"),e=$(this).find('input[name="name"]').val(),i=$(this).find('input[name="price"]').val();l[n]={display:!0,name:e,price:i}})}function a(){var n=p.find('.inventory-add input[name="name"]'),e=p.find('.inventory-add input[name="price"]');$.post(c.post,{name:n.val(),price:e.val()}).done(function(i){i=JSON.parse(i),Paperwork.ready(p.find(".inventory-add .button"),"ADD"),n.val(""),e.val(""),n.focus(),Paperwork.send("inventory.add",{id:i.id,name:i.name,price:i.price}),Paperwork.send("notification","Saved")})}function t(n){return n.id?(n.price||(n.price=0),l[n.id]={display:!0,name:n.name,price:n.price},void o()):void console.warn("ID not suppied")}function o(){v.html("");for(var n in l){var e=l[n];e.display&&(e.price=Paperwork.dollar(e.price,{sign:!1}),v.prepend('\n				<li data-id="'+n+'">\n					<div class="item">\n						<input type="text" name="name" value="'+e.name+'" placeholder="'+e.name+'">\n						<input type="text" name="price" value="'+e.price+'" placeholder="'+e.price+'">\n						<div data-type="remove" class="remove-btn"></div>\n					</div>\n				</li>\n			'))}}function r(){p.on("change","ul input",function(){var n=$(this).closest("[data-id]"),e=n[0].attributes["data-id"].value,i=n.find('input[name="name"]').val(),a=n.find('input[name="price"]').val();i.length&&a.length&&e.length&&(l[e].name=i,l[e].price=a,$.post(c.put,{id:e,name:i,price:a}).done(function(n){n=JSON.parse(n),l[n.id].name=n.name,l[n.id].price=n.price,o(),Paperwork.send("notification","Saved")}))})}function d(){var n=$(this).closest("[data-id]");$.post(c["delete"],{id:n[0].attributes["data-id"].value}).done(function(e){n.remove(),Paperwork.send("notification","Saved")})}var p=n.element,v=p.find(".inventory-list"),c={put:environment.root+"/put/inventory",post:environment.root+"/post/inventory","delete":environment.root+"/delete/inventory"},l={};i(),r(),o(),p.on("click",".inventory-add .button",a),p.on("click",'[data-type="remove"]',d),Paperwork.on("inventory.add",t),Paperwork.validate(p.find(".inventory-add"),p.find(".inventory-add .button"),Paperwork.random(6),{allowDuplicates:!0}),p.on("keyup",".filter",e)});